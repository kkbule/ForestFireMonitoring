(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3df9f2e4"],{9813:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-comp-wrapper"},[e("el-tabs",{staticClass:"rs-tabs",attrs:{stretch:!0},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{name:"first"}},[e("span",{staticClass:"tabs-top-span",attrs:{slot:"label"},slot:"label"},[t._v("查询结果")]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"rs-tabs-div"},[e("div",{staticClass:"tabs-cxjg-one"},[e("el-checkbox",{staticClass:"all-check",on:{change:t.handleCheckAllChange},model:{value:t.isAllCheck,callback:function(e){t.isAllCheck=e},expression:"isAllCheck"}},[t._v("全选")]),e("div",{staticClass:"cxjg-span"},[e("span",[t._v("查询结果")]),e("span",{staticStyle:{color:"#F99600"}},[t._v(t._s(t.sceneNumber))]),e("span",[t._v("景，已选择")]),e("span",{staticStyle:{color:"#21D59B"}},[t._v(t._s(t.checkResultNum))]),e("span",[t._v("景")])])],1),e("ul",{staticClass:"tabs-cxjg-ul"},t._l(t.searchResultList,(function(a,s){return e("li",{key:s,staticClass:"active"},[e("div",{staticClass:"content"},[e("el-checkbox",{attrs:{disabled:null==a.dmServiceUrlEntity},on:{change:e=>t.handleCheckedCitiesChange(e,a)}}),e("div",{staticClass:"img-box"},[a.thumbnail?e("img",{attrs:{src:"data:image/jpeg;base64,"+a.thumbnail}}):e("el-image")],1),e("div",{staticClass:"tabs-cxjg-two"},[e("ul",[e("li",[e("span",{staticClass:"tabs-cxjg-two-span"},[t._v("卫星：")]),e("span",[t._v(t._s(a.satellite))])]),e("li",[e("span",{staticClass:"tabs-cxjg-two-span"},[t._v("传感器：")]),e("span",[t._v(t._s(a.sensorid))])]),e("li",[e("span",{staticClass:"tabs-cxjg-two-span"},[t._v("云量：")]),e("span",[t._v(t._s(a.cloudperce))])]),e("li",[e("span",{staticClass:"tabs-cxjg-two-span"},[t._v("时间：")]),e("span",[t._v(t._s(a.acquisitio))])])])])],1),e("div",{staticClass:"tabs-cxjg-three"},[e("div",{staticClass:"xq"},[t._v("预览")]),e("div",{staticClass:"dw",on:{click:function(e){return t.positionGeojson(a)}}},[t._v("定位")])])])})),0),e("div",{staticClass:"bottom-btn"},[e("el-button",{staticClass:"e-btn-blue",attrs:{size:"small",type:"primary"},on:{click:function(t){}}},[t._v("导出")]),e("el-button",{staticClass:"e-btn-grey",attrs:{size:"small",plain:""},on:{click:t.closeBox}},[t._v("关闭")])],1)])]),e("el-tab-pane",{attrs:{name:"second"}},[e("span",{staticClass:"tabs-top-span",attrs:{slot:"label"},slot:"label"},[t._v("覆盖率结果")]),e("div",{staticClass:"rs-tabs-div"},[e("div",{staticClass:"fgl-content"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"list-table",attrs:{data:t.fglResult,stripe:"",border:"",width:"100%",size:"small","highlight-current-row":"","row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[e("el-table-column",{attrs:{prop:"name",label:"卫星",align:"left","min-width":"20%"}}),e("el-table-column",{attrs:{prop:"coverage",label:"覆盖率%",align:"left","min-width":"15%"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.dateFormat(e.row.coverage))+" ")]}}])}),e("el-table-column",{attrs:{prop:"sceneNumber",label:"景数",align:"left","min-width":"12%"}})],1)],1),e("div",{staticClass:"bottom-btn"},[e("el-button",{staticClass:"e-btn-blue",attrs:{size:"small",type:"primary"},on:{click:function(t){}}},[t._v("导出")]),e("el-button",{staticClass:"e-btn-grey",attrs:{size:"small",plain:""},on:{click:t.closeBox}},[t._v("关闭")])],1)])])],1)],1)},i=[],l=(a("14d9"),a("eb1c")),c={name:"result-search",props:["propData"],data(){return{loading:!0,activeName:"first",batch:"",isAllCheck:!1,sceneNumber:"",checkResultNum:0,searchResultList:[],tableLoading:!1,fglResult:[],wktStr:"",space:"",beginDate:"",endDate:"",cloudperce:[],satellite:[],lastImagerLayerSmid:[]}},watch:{propData:function(t,e){this.batch=t.batch,this.wktStr=t.wktStr,this.space=t.space,this.beginDate=t.beginDate,this.endDate=t.endDate,this.cloudperce=t.cloudperce,this.satellite=t.satellite,this.batch?this.getData():this.getDataSearch(),console.log("右侧组件展示",t)}},created(){console.log("右侧组件展示初始化",this.propData)},mounted:function(){this.propData&&(this.batch=this.propData.batch,this.wktStr=this.propData.wktStr,this.space=this.propData.space,this.beginDate=this.propData.beginDate,this.endDate=this.propData.endDate,this.cloudperce=this.propData.cloudperce,this.satellite=this.propData.satellite,this.batch?this.getData():this.getDataSearch())},methods:{handleClick(t,e){console.log(t)},getDataSearch(){this.loading=!0,this.searchResultList=[],this.fglResult=[];const t={wktStr:this.wktStr,space:this.space,beginDate:this.beginDate,endDate:this.endDate,begin:this.cloudperce[0],end:this.cloudperce[1],satellite:this.satellite};l["a"].getDataSearch(t).then(t=>{if(console.log(t),200==t.data.status){let e=t.data.result;if(e.list){this.searchResultList=e.list,this.sceneNumber=this.searchResultList.length,this.fglResult=e.coverage;let t=JSON.parse(JSON.stringify(e.list));console.log(t);let a=t.map(t=>JSON.parse(t.geojson));addGeoJson(g_config.globalviewer,OL_CommonTools.createGeojsonByFeatures(a),{polyline:{color:"#B407FF"}}),this.clearDS()}this.loading=!1}else this.loading=!1})},getData(){this.loading=!0,this.searchResultList=[],this.fglResult=[],l["a"].getList(this.batch).then(t=>{if(200==t.data.status){let e=t.data.result;e.list&&(this.searchResultList=e.list,this.fglResult=e.coverage,this.sceneNumber=this.searchResultList.length),this.loading=!1}else this.loading=!1})},getBatchCoverage(){this.fglResult=[],l["a"].getBatchCoverage(this.batch).then(t=>{if(200==t.data.status){let e=t.data.result;e&&(this.fglResult=e)}})},positionGeojson(t){addVectorHightByGeojsonNoFly(g_config.globalviewer,OL_CommonTools.createGeojsonByFeatures([JSON.parse(t.geojson)]))},closeBox(){addVectorHightByGeojsonNoFly(g_config.globalviewer,null),this.lastImagerLayerSmid.length>0&&this.lastImagerLayerSmid.forEach(t=>{Layer.removeImageryLayerById(t)}),this.BCUtil.closeBoxComponent()},handleCheckAllChange(t){this.checkResultNum=t?this.sceneNumber:0},handleCheckedCitiesChange(t,e){console.log(e);let a={};e.dmServiceUrlEntity.forEach(t=>{"WMTS"==t.serviceType&&(a.serviceUrl=t.serviceUrl,a.smId="pcxx-checked-"+t.smId)}),a.smGridSet=e.smGridSet,a.minX=e.minX,a.minY=e.minY,a.maxX=e.maxX,a.maxY=e.maxY,t?(this.lastImagerLayerSmid.push(a.smId),a.layer=a.serviceUrl.substr(a.serviceUrl.indexOf("layer=")+6),g_config.globalviewer.imageryLayers.add(Layer.IC_WMTS(a)),this.utils.opeNotify("","top-center","加载成功！","3500","success")):(this.lastImagerLayerSmid.map((t,e)=>{t===a.smId&&this.lastImagerLayerSmid.splice(e,1)}),Layer.removeImageryLayerById(a.smId)),console.log(this.lastImagerLayerSmid)},clearDS(){g_config.globalviewer.graphicLayer.clear(),removeGeoJsonDataSource("3d-vector-templayer",g_config.globalviewer)},dateFormat(t){if(""!=t)return Number(t).toFixed(2)}}},r=c,n=(a("f06a"),a("2877")),o=Object(n["a"])(r,s,i,!1,null,"0c0bef06",null);e["default"]=o.exports},b663:function(t,e,a){},eb1c:function(t,e,a){"use strict";var s=a("b775"),i=a("f121"),l=a("1a78");class c extends l["a"]{satellitePage(t,e){return t=Object.assign(t,e),Object(s["b"])(i["a"].bigdataURL+"/satellite-task/satellite-page",t)}getList(t){return Object(s["b"])(i["a"].bigdataURL+"/satellite-task/getList/"+t)}getBatchCoverage(t){return Object(s["b"])(i["a"].bigdataURL+"/satellite-task/getBatchCoverage/"+t)}getDataSearch(t){return Object(s["c"])(i["a"].bigdataURL+"/satellite-task/data-search/",t)}getCount(){return Object(s["b"])(i["a"].bigdataURL+"/satellite-task/count")}getDataStatistics(t){return Object(s["b"])(i["a"].bigdataURL+"/satellite-task/data-statistics/",t)}getDataCoverage(t){return Object(s["b"])(i["a"].bigdataURL+"/satellite-task/data-coverage/",t)}getInfo(t){return Object(s["b"])(i["a"].bigdataURL+"/satellite-task/getInfo/"+t)}getSatelliteImagePath(){return"http://127.0.0.1/statellite/"}}e["a"]=new c(i["a"].bigdataURL+"/satellite-task")},f06a:function(t,e,a){"use strict";a("b663")}}]);